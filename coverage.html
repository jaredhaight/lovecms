
<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>cmd: Go Coverage Report</title>
		<style>
			body {
				background: black;
				color: rgb(80, 80, 80);
			}
			body, pre, #legend span {
				font-family: Menlo, monospace;
				font-weight: bold;
			}
			#topbar {
				background: black;
				position: fixed;
				top: 0; left: 0; right: 0;
				height: 42px;
				border-bottom: 1px solid rgb(80, 80, 80);
			}
			#content {
				margin-top: 50px;
			}
			#nav, #legend {
				float: left;
				margin-left: 10px;
			}
			#legend {
				margin-top: 12px;
			}
			#nav {
				margin-top: 10px;
			}
			#legend span {
				margin: 0 5px;
			}
			.cov0 { color: rgb(192, 0, 0) }
.cov1 { color: rgb(128, 128, 128) }
.cov2 { color: rgb(116, 140, 131) }
.cov3 { color: rgb(104, 152, 134) }
.cov4 { color: rgb(92, 164, 137) }
.cov5 { color: rgb(80, 176, 140) }
.cov6 { color: rgb(68, 188, 143) }
.cov7 { color: rgb(56, 200, 146) }
.cov8 { color: rgb(44, 212, 149) }
.cov9 { color: rgb(32, 224, 152) }
.cov10 { color: rgb(20, 236, 155) }

		</style>
	</head>
	<body>
		<div id="topbar">
			<div id="nav">
				<select id="files">
				
				<option value="file0">github.com/jaredhaight/lovecms/cmd/main.go (9.8%)</option>
				
				<option value="file1">github.com/jaredhaight/lovecms/internal/application/cms.go (86.8%)</option>
				
				<option value="file2">github.com/jaredhaight/lovecms/internal/application/management.go (93.0%)</option>
				
				<option value="file3">github.com/jaredhaight/lovecms/internal/templates/editor_templ.go (0.0%)</option>
				
				<option value="file4">github.com/jaredhaight/lovecms/internal/templates/home_templ.go (0.0%)</option>
				
				<option value="file5">github.com/jaredhaight/lovecms/internal/templates/layout_templ.go (0.0%)</option>
				
				<option value="file6">github.com/jaredhaight/lovecms/internal/testhelpers/helpers.go (0.0%)</option>
				
				</select>
			</div>
			<div id="legend">
				<span>not tracked</span>
			
				<span class="cov0">no coverage</span>
				<span class="cov1">low coverage</span>
				<span class="cov2">*</span>
				<span class="cov3">*</span>
				<span class="cov4">*</span>
				<span class="cov5">*</span>
				<span class="cov6">*</span>
				<span class="cov7">*</span>
				<span class="cov8">*</span>
				<span class="cov9">*</span>
				<span class="cov10">high coverage</span>
			
			</div>
		</div>
		<div id="content">
		
		<pre class="file" id="file0" style="display: none">package main

import (
        "errors"
        "flag"
        "fmt"
        "log/slog"
        "net/http"
        "os"
        "path/filepath"
        "runtime"

        "github.com/charmbracelet/log"
        "github.com/jaredhaight/lovecms/internal/application"
        "github.com/spf13/viper"
)

var debugLogging = flag.Bool("debug", false, "Enable debug logging")

// Get our paths - cross platform
func getConfigDir() string <span class="cov10" title="6">{
        if runtime.GOOS == "windows" </span><span class="cov0" title="0">{
                return filepath.Join(os.Getenv("APPDATA"), "lovecms")
        }</span>
        // For macOS/Linux, use home directory
        <span class="cov10" title="6">homeDir, err := os.UserHomeDir()
        if err != nil </span><span class="cov0" title="0">{
                return "."
        }</span>
        <span class="cov10" title="6">return filepath.Join(homeDir, ".lovecms")</span>
}

var loveCmsDir = getConfigDir()

func main() <span class="cov0" title="0">{
        flag.Parse()

        // logging defaults
        logLevel := log.InfoLevel
        addSource := false

        if *debugLogging </span><span class="cov0" title="0">{
                logLevel = log.DebugLevel
                addSource = true
        }</span>

        // setup logging
        <span class="cov0" title="0">opts := log.Options{
                Level:        logLevel,
                ReportCaller: addSource,
        }

        logger := slog.New(log.NewWithOptions(os.Stderr, opts))

        // make sure our directory exists
        err := os.MkdirAll(loveCmsDir, os.ModePerm)
        if err != nil </span><span class="cov0" title="0">{
                logger.Error(err.Error())
                os.Exit(1)
        }</span>

        // setup config stuff
        <span class="cov0" title="0">v := viper.New()
        v.AddConfigPath(loveCmsDir)
        v.SetConfigName("config")
        v.SetConfigType("json")
        v.SetDefault("SitePath", "")
        v.SetDefault("Port", 8143)

        // load config
        err = v.ReadInConfig()
        if errors.Is(err, viper.ConfigFileNotFoundError{}) </span><span class="cov0" title="0">{
                // if we can't find a config file, create it
                err = v.SafeWriteConfig()
                if err != nil </span><span class="cov0" title="0">{
                        logger.Error(err.Error())
                        os.Exit(1)
                }</span>
        }

        <span class="cov0" title="0">var port = v.GetInt("Port")

        // setup our servers
        mux := http.NewServeMux()
        fileServer := http.FileServer(http.Dir("./static"))

        // setup handlers
        mux.Handle("GET /static/", http.StripPrefix("/static", fileServer))
        mux.HandleFunc("GET /{$}", application.NewCmsHandler(v, logger).GetHome)
        mux.HandleFunc("GET /editor", application.NewCmsHandler(v, logger).GetEditor)
        mux.HandleFunc("POST /editor", application.NewCmsHandler(v, logger).PostEditor)

        // start server
        logger.Info(fmt.Sprintf("Starting server on http://localhost:%d", port))

        listen := fmt.Sprintf(":%d", port)
        err = http.ListenAndServe(listen, mux)
        logger.Error("Error starting server", "error", err)</span>
}
</pre>
		
		<pre class="file" id="file1" style="display: none">package application

import (
        "log/slog"
        "net/http"
        "path/filepath"
        "strings"
        "time"

        "github.com/jaredhaight/lovecms/internal/templates"
        "github.com/jaredhaight/lovecms/internal/types"
        "github.com/spf13/viper"
)

type CmsHandler struct {
        config *viper.Viper
        logger *slog.Logger
}

func NewCmsHandler(v *viper.Viper, l *slog.Logger) *CmsHandler <span class="cov10" title="12">{
        return &amp;CmsHandler{
                config: v,
                logger: l,
        }
}</span>

// GET /
func (h *CmsHandler) GetHome(w http.ResponseWriter, r *http.Request) <span class="cov3" title="2">{
        // get sitepath
        var sitePath = h.config.GetString("SitePath")

        // if we don't have a site defined, redirect to setup
        if sitePath == "" </span><span class="cov1" title="1">{
                h.logger.Info("No current site defined. Redirecting to setup")
                http.Redirect(w, r, "/setup", http.StatusFound)
        }</span>

        <span class="cov3" title="2">contentPath := filepath.Join(sitePath, "content")
        // Load our application
        p, err := GetPosts(contentPath)
        if err != nil </span><span class="cov1" title="1">{
                h.logger.Error("Error loading application: ", "err", err)
                http.Error(w, "Error parsing web", http.StatusInternalServerError)
                return
        }</span>

        <span class="cov1" title="1">c := templates.Home(p)
        err = templates.Layout(c).Render(r.Context(), w)

        if err != nil </span><span class="cov0" title="0">{
                http.Error(w, "Error rendering template", http.StatusInternalServerError)
                return
        }</span>
}

// GET /editor/?path=Foo
func (h *CmsHandler) GetEditor(w http.ResponseWriter, r *http.Request) <span class="cov6" title="5">{
        // get sitepath
        var sitePath = h.config.GetString("SitePath")

        // if we don't have a site defined, redirect to setup
        if sitePath == "" </span><span class="cov1" title="1">{
                h.logger.Info("No current site defined. Redirecting to setup")
                http.Redirect(w, r, "/setup", http.StatusFound)
                return
        }</span>

        // if we're at /post/new, we need to just render the CMS
        <span class="cov6" title="4">if r.URL.Path == "/post/new" </span><span class="cov1" title="1">{
                // Create a new post form
                c := templates.Editor(types.Post{}, false)
                err := templates.Layout(c).Render(r.Context(), w)

                if err != nil </span><span class="cov0" title="0">{
                        http.Error(w, "Error rendering template", http.StatusInternalServerError)
                        return
                }</span>
                <span class="cov1" title="1">return</span>
        }

        // if we're at /post/edit, we need to load the existing post
        <span class="cov4" title="3">postPath := r.URL.Query().Get("path")

        // if no path is provided, return an error
        if postPath == "" </span><span class="cov1" title="1">{
                http.Error(w, "Post path required", http.StatusBadRequest)
                return
        }</span>

        // Load the existing post
        <span class="cov3" title="2">post, err := GetPost(postPath)

        if err != nil </span><span class="cov1" title="1">{
                h.logger.Error("Error loading post", "err", err)
                http.Error(w, "Error loading post", http.StatusInternalServerError)
                return
        }</span>

        <span class="cov1" title="1">c := templates.Editor(post, true)
        err = templates.Layout(c).Render(r.Context(), w)

        if err != nil </span><span class="cov0" title="0">{
                http.Error(w, "Error rendering template", http.StatusInternalServerError)
                return
        }</span>
}

// POST /editor/
func (h *CmsHandler) PostEditor(w http.ResponseWriter, r *http.Request) <span class="cov6" title="4">{
        // get sitepath
        var sitePath = h.config.GetString("SitePath")

        // if we don't have a site defined, redirect to setup
        if sitePath == "" </span><span class="cov1" title="1">{
                h.logger.Info("No current site defined. Redirecting to setup")
                http.Redirect(w, r, "/setup", http.StatusFound)
                return
        }</span>

        // Parse form data
        <span class="cov4" title="3">err := r.ParseForm()
        if err != nil </span><span class="cov1" title="1">{
                h.logger.Error("Error parsing form", "err", err)
                http.Error(w, "Error parsing form", http.StatusBadRequest)
                return
        }</span>

        <span class="cov3" title="2">title := r.FormValue("title")
        content := r.FormValue("content")
        slug := r.FormValue("slug")
        tags := r.FormValue("tags")

        // Parse tags (comma-separated)
        var tagList []string
        if tags != "" </span><span class="cov3" title="2">{
                for _, tag := range strings.Split(tags, ",") </span><span class="cov4" title="3">{
                        tagList = append(tagList, strings.TrimSpace(tag))
                }</span>
        }

        // Create post
        <span class="cov3" title="2">post := types.Post{
                Metadata: types.FrontMatter{
                        Title:       title,
                        Date:        time.Now().Format("2006-01-02T15:04:05Z07:00"),
                        Draft:       r.FormValue("draft") == "on",
                        PublishDate: time.Now().Format("2006-01-02T15:04:05Z07:00"),
                        Slug:        slug,
                        Tags:        tagList,
                },
                Content: content,
        }

        // Create the post file
        contentPath := filepath.Join(sitePath, "content")
        err = CreatePost(contentPath, post)
        if err != nil </span><span class="cov0" title="0">{
                h.logger.Error("Error creating post", "err", err)
                http.Error(w, "Error creating post", http.StatusInternalServerError)
                return
        }</span>

        // Redirect to home page
        <span class="cov3" title="2">http.Redirect(w, r, "/", http.StatusSeeOther)</span>
}
</pre>
		
		<pre class="file" id="file2" style="display: none">package application

import (
        "bytes"
        "errors"
        "os"
        "path/filepath"
        "sort"
        "strings"

        "github.com/adrg/frontmatter"
        "github.com/jaredhaight/lovecms/internal/types"
        "github.com/yuin/goldmark"
        "gopkg.in/yaml.v3"
)

func GetPost(postPath string) (types.Post, error) <span class="cov4" title="7">{
        // read file contents
        content, err := os.Open(postPath)

        if err != nil </span><span class="cov1" title="1">{
                return types.Post{}, err
        }</span>

        // parse front matter
        <span class="cov4" title="6">fm := types.FrontMatter{}
        rest, err := frontmatter.Parse(content, &amp;fm)
        if err != nil </span><span class="cov0" title="0">{

                return types.Post{}, err
        }</span>

        // Markdown -&gt; HTML
        <span class="cov4" title="6">var buf bytes.Buffer
        md := goldmark.New()

        err = md.Convert(rest, &amp;buf)
        if err != nil </span><span class="cov0" title="0">{
                return types.Post{}, err
        }</span>

        <span class="cov4" title="6">post := types.Post{
                Metadata: fm,
                FileName: filepath.Base(postPath),
                FilePath: postPath,
                Content:  buf.String(),
        }

        return post, nil</span>
}

func GetPosts(directoryPath string) ([]types.Post, error) <span class="cov4" title="7">{
        if directoryPath == "" </span><span class="cov1" title="1">{
                return nil, errors.New("directoryPath is empty")
        }</span>

        // get files from the content folder
        <span class="cov4" title="6">entries, err := os.ReadDir(directoryPath)
        if err != nil </span><span class="cov2" title="2">{
                return nil, err
        }</span>

        // create a post object for each item
        <span class="cov3" title="4">var post types.Post
        var posts []types.Post
        for _, entry := range entries </span><span class="cov4" title="6">{
                ext := filepath.Ext(entry.Name())

                if ext == ".md" || ext == ".markdown" </span><span class="cov3" title="5">{
                        postPath := filepath.Join(directoryPath, entry.Name())
                        post, err = GetPost(postPath)

                        if err != nil </span><span class="cov0" title="0">{
                                return nil, err
                        }</span>

                        <span class="cov3" title="5">posts = append(posts, post)</span>
                }
        }

        // sort application by date
        <span class="cov3" title="4">sort.Slice(posts, func(i, j int) bool </span><span class="cov2" title="2">{
                return posts[i].Metadata.Date &gt; posts[j].Metadata.Date
        }</span>)
        <span class="cov3" title="4">return posts, nil</span>
}

func UpdatePost(post types.Post) error <span class="cov5" title="14">{
        // get frontmatter
        meta, err := yaml.Marshal(post.Metadata)
        if err != nil </span><span class="cov0" title="0">{
                return err
        }</span>

        // create file content
        <span class="cov5" title="14">sb := strings.Builder{}
        sb.WriteString("---\n")
        sb.WriteString(string(meta))
        sb.WriteString("---\n")
        sb.WriteString(post.Content)

        // write content to disk
        err = os.WriteFile(post.FilePath, []byte(sb.String()), 0644)
        if err != nil </span><span class="cov2" title="2">{
                return err
        }</span>

        <span class="cov5" title="12">return nil</span>
}

func CreatePost(contentPath string, post types.Post) error <span class="cov5" title="12">{
        // Generate filename from title if slug is empty
        var filename string
        if post.Metadata.Slug != "" </span><span class="cov2" title="3">{
                filename = post.Metadata.Slug + ".md"
        }</span> else<span class="cov4" title="9"> {
                // Simple slug generation from title
                slug := strings.ToLower(post.Metadata.Title)
                slug = strings.ReplaceAll(slug, " ", "-")
                // Remove special characters (basic implementation)
                slug = strings.Map(func(r rune) rune </span><span class="cov10" title="175">{
                        if (r &gt;= 'a' &amp;&amp; r &lt;= 'z') || (r &gt;= '0' &amp;&amp; r &lt;= '9') || r == '-' </span><span class="cov9" title="166">{
                                return r
                        }</span>
                        <span class="cov4" title="9">return -1</span>
                }, slug)
                <span class="cov4" title="9">filename = slug + ".md"
                post.Metadata.Slug = slug</span>
        }

        // Set the file path
        <span class="cov5" title="12">post.FilePath = filepath.Join(contentPath, filename)

        // Use UpdatePost to write the file
        return UpdatePost(post)</span>
}
</pre>
		
		<pre class="file" id="file3" style="display: none">// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.906
package templates

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import "github.com/jaredhaight/lovecms/internal/types"
import "strings"

func Editor(post types.Post, isEdit bool) templ.Component <span class="cov0" title="0">{
        return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) </span><span class="cov0" title="0">{
                templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
                if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_CtxErr
                }</span>
                <span class="cov0" title="0">templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
                if !templ_7745c5c3_IsBuffer </span><span class="cov0" title="0">{
                        defer func() </span><span class="cov0" title="0">{
                                templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
                                if templ_7745c5c3_Err == nil </span><span class="cov0" title="0">{
                                        templ_7745c5c3_Err = templ_7745c5c3_BufErr
                                }</span>
                        }()
                }
                <span class="cov0" title="0">ctx = templ.InitializeContext(ctx)
                templ_7745c5c3_Var1 := templ.GetChildren(ctx)
                if templ_7745c5c3_Var1 == nil </span><span class="cov0" title="0">{
                        templ_7745c5c3_Var1 = templ.NopComponent
                }</span>
                <span class="cov0" title="0">ctx = templ.ClearChildren(ctx)
                templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "&lt;div class=\"flex flex-col prose w-full max-w-4xl mx-auto\"&gt;&lt;div class=\"mb-6\"&gt;")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">if isEdit </span><span class="cov0" title="0">{
                        templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "&lt;h1&gt;Edit Post&lt;/h1&gt;")
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                } else<span class="cov0" title="0"> {
                        templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "&lt;h1&gt;Create New Post&lt;/h1&gt;")
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                }
                <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "&lt;/div&gt;&lt;form method=\"POST\" class=\"space-y-4\"&gt;&lt;div class=\"form-control w-full\"&gt;&lt;label class=\"label\"&gt;&lt;span class=\"label-text\"&gt;Title&lt;/span&gt;&lt;/label&gt; &lt;input type=\"text\" name=\"title\" value=\"")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">var templ_7745c5c3_Var2 string
                templ_7745c5c3_Var2, templ_7745c5c3_Err = templ.JoinStringErrs(post.Metadata.Title)
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/templates/editor.templ`, Line: 21, Col: 75}
                }</span>
                <span class="cov0" title="0">_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var2))
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "\" placeholder=\"Enter post title\" class=\"input input-bordered w-full\" required&gt;&lt;/div&gt;&lt;div class=\"form-control w-full\"&gt;&lt;label class=\"label\"&gt;&lt;span class=\"label-text\"&gt;Slug (URL-friendly name)&lt;/span&gt;&lt;/label&gt; &lt;input type=\"text\" name=\"slug\" value=\"")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">var templ_7745c5c3_Var3 string
                templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(post.Metadata.Slug)
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/templates/editor.templ`, Line: 28, Col: 73}
                }</span>
                <span class="cov0" title="0">_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "\" placeholder=\"post-slug\" class=\"input input-bordered w-full\"&gt; &lt;label class=\"label\"&gt;&lt;span class=\"label-text-alt\"&gt;Leave empty to auto-generate from title&lt;/span&gt;&lt;/label&gt;&lt;/div&gt;&lt;div class=\"form-control w-full\"&gt;&lt;label class=\"label\"&gt;&lt;span class=\"label-text\"&gt;Tags&lt;/span&gt;&lt;/label&gt; &lt;input type=\"text\" name=\"tags\" value=\"")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">var templ_7745c5c3_Var4 string
                templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(strings.Join(post.Metadata.Tags, ", "))
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/templates/editor.templ`, Line: 38, Col: 93}
                }</span>
                <span class="cov0" title="0">_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "\" placeholder=\"tag1, tag2, tag3\" class=\"input input-bordered w-full\"&gt; &lt;label class=\"label\"&gt;&lt;span class=\"label-text-alt\"&gt;Separate tags with commas&lt;/span&gt;&lt;/label&gt;&lt;/div&gt;&lt;div class=\"form-control\"&gt;&lt;label class=\"label cursor-pointer justify-start\"&gt;&lt;input type=\"checkbox\" name=\"draft\" class=\"checkbox\"")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">if post.Metadata.Draft </span><span class="cov0" title="0">{
                        templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, " checked")
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                }
                <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "&gt; &lt;span class=\"label-text ml-2\"&gt;Save as draft&lt;/span&gt;&lt;/label&gt;&lt;/div&gt;&lt;div class=\"form-control w-full\"&gt;&lt;label class=\"label\"&gt;&lt;span class=\"label-text\"&gt;Content&lt;/span&gt;&lt;/label&gt; &lt;textarea name=\"content\" rows=\"20\" placeholder=\"Write your post content in Markdown...\" class=\"textarea textarea-bordered w-full h-96\"&gt;")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">var templ_7745c5c3_Var5 string
                templ_7745c5c3_Var5, templ_7745c5c3_Err = templ.JoinStringErrs(post.Content)
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/templates/editor.templ`, Line: 58, Col: 165}
                }</span>
                <span class="cov0" title="0">_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var5))
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "&lt;/textarea&gt;&lt;/div&gt;&lt;div class=\"flex gap-4 pt-4\"&gt;&lt;button type=\"submit\" class=\"btn btn-primary\"&gt;")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">if isEdit </span><span class="cov0" title="0">{
                        templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 11, "Update Post")
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                } else<span class="cov0" title="0"> {
                        templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 12, "Create Post")
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                }
                <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 13, "&lt;/button&gt; &lt;a href=\"/\" class=\"btn btn-secondary\"&gt;Cancel&lt;/a&gt;&lt;/div&gt;&lt;/form&gt;&lt;/div&gt;")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">return nil</span>
        })
}

var _ = templruntime.GeneratedTemplate
</pre>
		
		<pre class="file" id="file4" style="display: none">// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.906
package templates

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import "github.com/jaredhaight/lovecms/internal/types"

func Home(posts []types.Post) templ.Component <span class="cov0" title="0">{
        return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) </span><span class="cov0" title="0">{
                templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
                if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_CtxErr
                }</span>
                <span class="cov0" title="0">templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
                if !templ_7745c5c3_IsBuffer </span><span class="cov0" title="0">{
                        defer func() </span><span class="cov0" title="0">{
                                templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
                                if templ_7745c5c3_Err == nil </span><span class="cov0" title="0">{
                                        templ_7745c5c3_Err = templ_7745c5c3_BufErr
                                }</span>
                        }()
                }
                <span class="cov0" title="0">ctx = templ.InitializeContext(ctx)
                templ_7745c5c3_Var1 := templ.GetChildren(ctx)
                if templ_7745c5c3_Var1 == nil </span><span class="cov0" title="0">{
                        templ_7745c5c3_Var1 = templ.NopComponent
                }</span>
                <span class="cov0" title="0">ctx = templ.ClearChildren(ctx)
                var i = 0
                templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "&lt;div class=\"flex-row prose\"&gt;&lt;div class=\"flex justify-between items-center mb-6\"&gt;&lt;h1 class=\"m-0 p-0\"&gt;Posts&lt;/h1&gt;&lt;button class=\"btn btn-soft btn-primary\"&gt;&lt;a href=\"/editor/\"&gt;Create New Post&lt;/a&gt;&lt;/button&gt;&lt;/div&gt;")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">for _, post := range posts </span><span class="cov0" title="0">{
                        if i != 0 </span><span class="cov0" title="0">{
                                templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "&lt;div class=\"divider\"&gt;&lt;/div&gt;")
                                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                        return templ_7745c5c3_Err
                                }</span>
                        }
                        <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, " &lt;div class=\"min-w-96\"&gt;&lt;h2&gt;&lt;a class=\"\" href=\"")
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                        <span class="cov0" title="0">var templ_7745c5c3_Var2 templ.SafeURL
                        templ_7745c5c3_Var2, templ_7745c5c3_Err = templ.JoinURLErrs(templ.URL("/editor/?path=" + post.FilePath))
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/templates/home.templ`, Line: 20, Col: 76}
                        }</span>
                        <span class="cov0" title="0">_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var2))
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                        <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "\"&gt;")
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                        <span class="cov0" title="0">var templ_7745c5c3_Var3 string
                        templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(post.Metadata.Title)
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/templates/home.templ`, Line: 20, Col: 100}
                        }</span>
                        <span class="cov0" title="0">_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                        <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "&lt;/a&gt;&lt;/h2&gt;&lt;p class=\"text-sm\"&gt;")
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                        <span class="cov0" title="0">for _, tag := range post.Metadata.Tags </span><span class="cov0" title="0">{
                                templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "&lt;span class=\"badge badge-secondary mx-1\"&gt;")
                                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                        return templ_7745c5c3_Err
                                }</span>
                                <span class="cov0" title="0">var templ_7745c5c3_Var4 string
                                templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(tag)
                                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                        return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/templates/home.templ`, Line: 23, Col: 58}
                                }</span>
                                <span class="cov0" title="0">_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
                                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                        return templ_7745c5c3_Err
                                }</span>
                                <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "&lt;/span&gt;")
                                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                        return templ_7745c5c3_Err
                                }</span>
                        }
                        <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "&lt;/p&gt;&lt;p class=\"text-sm\"&gt;Published: &lt;span x-data=\"{date: new Date($el.innerText)}\" x-text=\"date.toLocaleString()\" class=\"datetime\"&gt;")
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                        <span class="cov0" title="0">var templ_7745c5c3_Var5 string
                        templ_7745c5c3_Var5, templ_7745c5c3_Err = templ.JoinStringErrs(post.Metadata.Date)
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/templates/home.templ`, Line: 28, Col: 49}
                        }</span>
                        <span class="cov0" title="0">_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var5))
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                        <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "&lt;/span&gt;&lt;/p&gt;&lt;/div&gt;")
                        if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                                return templ_7745c5c3_Err
                        }</span>
                        <span class="cov0" title="0">i += 1</span>
                }
                <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "&lt;/div&gt;")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">return nil</span>
        })
}

var _ = templruntime.GeneratedTemplate
</pre>
		
		<pre class="file" id="file5" style="display: none">// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.906
package templates

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

func header() templ.Component <span class="cov0" title="0">{
        return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) </span><span class="cov0" title="0">{
                templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
                if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_CtxErr
                }</span>
                <span class="cov0" title="0">templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
                if !templ_7745c5c3_IsBuffer </span><span class="cov0" title="0">{
                        defer func() </span><span class="cov0" title="0">{
                                templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
                                if templ_7745c5c3_Err == nil </span><span class="cov0" title="0">{
                                        templ_7745c5c3_Err = templ_7745c5c3_BufErr
                                }</span>
                        }()
                }
                <span class="cov0" title="0">ctx = templ.InitializeContext(ctx)
                templ_7745c5c3_Var1 := templ.GetChildren(ctx)
                if templ_7745c5c3_Var1 == nil </span><span class="cov0" title="0">{
                        templ_7745c5c3_Var1 = templ.NopComponent
                }</span>
                <span class="cov0" title="0">ctx = templ.ClearChildren(ctx)
                templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "&lt;header&gt;&lt;div class=\"flex flex-row justify-center p-2\"&gt;&lt;h1 class=\"text-xl\"&gt;&lt;a href=\"/\"&gt;❤️CMS&lt;/a&gt;&lt;/h1&gt;&lt;/div&gt;&lt;/header&gt;")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">return nil</span>
        })
}

func Layout(contents templ.Component) templ.Component <span class="cov0" title="0">{
        return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) </span><span class="cov0" title="0">{
                templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
                if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_CtxErr
                }</span>
                <span class="cov0" title="0">templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
                if !templ_7745c5c3_IsBuffer </span><span class="cov0" title="0">{
                        defer func() </span><span class="cov0" title="0">{
                                templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
                                if templ_7745c5c3_Err == nil </span><span class="cov0" title="0">{
                                        templ_7745c5c3_Err = templ_7745c5c3_BufErr
                                }</span>
                        }()
                }
                <span class="cov0" title="0">ctx = templ.InitializeContext(ctx)
                templ_7745c5c3_Var2 := templ.GetChildren(ctx)
                if templ_7745c5c3_Var2 == nil </span><span class="cov0" title="0">{
                        templ_7745c5c3_Var2 = templ.NopComponent
                }</span>
                <span class="cov0" title="0">ctx = templ.ClearChildren(ctx)
                templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "&lt;!doctype html&gt;&lt;html lang=\"en\"&gt;&lt;head&gt;&lt;title&gt;❤️CMS&lt;/title&gt;&lt;meta charset=\"UTF-8\"&gt;&lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"&gt;&lt;link rel=\"stylesheet\" href=\"/static/css/lovecms.css\"&gt;&lt;!-- eventually we'll ship the below with the compiled binary --&gt;&lt;link href=\"https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css\" rel=\"stylesheet\"&gt;&lt;script src=\"https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4\"&gt;&lt;/script&gt;&lt;script src=\"https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js\"&gt;&lt;/script&gt;&lt;script src=\"//unpkg.com/alpinejs\" defer&gt;&lt;/script&gt;&lt;/head&gt;&lt;body class=\"flex flex-col\"&gt;")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">templ_7745c5c3_Err = header().Render(ctx, templ_7745c5c3_Buffer)
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "&lt;main class=\"flex px-10 md:px-20 justify-center\"&gt;")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">templ_7745c5c3_Err = contents.Render(ctx, templ_7745c5c3_Buffer)
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "&lt;/main&gt;&lt;/body&gt;&lt;script&gt;\n      const quill = new Quill('#editor', {\n        theme: 'snow'\n      });\n    &lt;/script&gt;&lt;/html&gt;")
                if templ_7745c5c3_Err != nil </span><span class="cov0" title="0">{
                        return templ_7745c5c3_Err
                }</span>
                <span class="cov0" title="0">return nil</span>
        })
}

var _ = templruntime.GeneratedTemplate
</pre>
		
		<pre class="file" id="file6" style="display: none">// Package testhelpers provides common utilities for testing LoveCMS
package testhelpers

import (
        "os"
        "path/filepath"
        "testing"

        "github.com/jaredhaight/lovecms/internal/application"
        "github.com/jaredhaight/lovecms/internal/types"
)

// CreateTempSite creates a temporary directory structure that mimics a LoveCMS site
func CreateTempSite(t *testing.T) (siteDir string, cleanup func()) <span class="cov0" title="0">{
        t.Helper()

        tempDir, err := os.MkdirTemp("", "lovecms_test_site")
        if err != nil </span><span class="cov0" title="0">{
                t.Fatalf("Failed to create temp site dir: %v", err)
        }</span>

        // Create content directory
        <span class="cov0" title="0">contentDir := filepath.Join(tempDir, "content")
        err = os.MkdirAll(contentDir, 0755)
        if err != nil </span><span class="cov0" title="0">{
                t.Fatalf("Failed to create content dir: %v", err)
                os.RemoveAll(tempDir)
        }</span>

        <span class="cov0" title="0">cleanup = func() </span><span class="cov0" title="0">{
                os.RemoveAll(tempDir)
        }</span>

        <span class="cov0" title="0">return tempDir, cleanup</span>
}

// CreateTestPost creates a test post file in the specified directory
func CreateTestPost(t *testing.T, contentDir, filename string, post types.Post) string <span class="cov0" title="0">{
        t.Helper()

        // Set the file path
        post.FilePath = filepath.Join(contentDir, filename)

        // Create the post
        err := application.UpdatePost(post)
        if err != nil </span><span class="cov0" title="0">{
                t.Fatalf("Failed to create test post: %v", err)
        }</span>

        <span class="cov0" title="0">return post.FilePath</span>
}

// CreateSamplePosts creates a set of sample posts for testing
func CreateSamplePosts(t *testing.T, contentDir string) []string <span class="cov0" title="0">{
        t.Helper()

        posts := []types.Post{
                {
                        Metadata: types.FrontMatter{
                                Title:       "First Test Post",
                                Date:        "2023-01-03T00:00:00Z",
                                Draft:       false,
                                PublishDate: "2023-01-03T00:00:00Z",
                                Slug:        "first-test-post",
                                Tags:        []string{"test", "first"},
                        },
                        Content: "# First Test Post\n\nThis is the content of the first test post.",
                },
                {
                        Metadata: types.FrontMatter{
                                Title:       "Second Test Post",
                                Date:        "2023-01-02T00:00:00Z",
                                Draft:       false,
                                PublishDate: "2023-01-02T00:00:00Z",
                                Slug:        "second-test-post",
                                Tags:        []string{"test", "second"},
                        },
                        Content: "# Second Test Post\n\nThis is the content of the second test post.",
                },
                {
                        Metadata: types.FrontMatter{
                                Title:       "Draft Post",
                                Date:        "2023-01-01T00:00:00Z",
                                Draft:       true,
                                PublishDate: "2023-01-01T00:00:00Z",
                                Slug:        "draft-post",
                                Tags:        []string{"test", "draft"},
                        },
                        Content: "# Draft Post\n\nThis is a draft post.",
                },
        }

        var filePaths []string
        for i, post := range posts </span><span class="cov0" title="0">{
                filename := post.Metadata.Slug + ".md"
                filePath := CreateTestPost(t, contentDir, filename, post)
                filePaths = append(filePaths, filePath)
                _ = i // Avoid unused variable
        }</span>

        <span class="cov0" title="0">return filePaths</span>
}

// AssertPostEqual compares two posts for equality
func AssertPostEqual(t *testing.T, got, want types.Post) <span class="cov0" title="0">{
        t.Helper()

        if got.Metadata.Title != want.Metadata.Title </span><span class="cov0" title="0">{
                t.Errorf("Post title = %v, want %v", got.Metadata.Title, want.Metadata.Title)
        }</span>

        <span class="cov0" title="0">if got.Metadata.Date != want.Metadata.Date </span><span class="cov0" title="0">{
                t.Errorf("Post date = %v, want %v", got.Metadata.Date, want.Metadata.Date)
        }</span>

        <span class="cov0" title="0">if got.Metadata.Draft != want.Metadata.Draft </span><span class="cov0" title="0">{
                t.Errorf("Post draft = %v, want %v", got.Metadata.Draft, want.Metadata.Draft)
        }</span>

        <span class="cov0" title="0">if got.Metadata.Slug != want.Metadata.Slug </span><span class="cov0" title="0">{
                t.Errorf("Post slug = %v, want %v", got.Metadata.Slug, want.Metadata.Slug)
        }</span>

        <span class="cov0" title="0">if len(got.Metadata.Tags) != len(want.Metadata.Tags) </span><span class="cov0" title="0">{
                t.Errorf("Post tags length = %v, want %v", len(got.Metadata.Tags), len(want.Metadata.Tags))
        }</span> else<span class="cov0" title="0"> {
                for i, tag := range got.Metadata.Tags </span><span class="cov0" title="0">{
                        if tag != want.Metadata.Tags[i] </span><span class="cov0" title="0">{
                                t.Errorf("Post tag[%d] = %v, want %v", i, tag, want.Metadata.Tags[i])
                        }</span>
                }
        }

        <span class="cov0" title="0">if got.Content != want.Content </span><span class="cov0" title="0">{
                t.Errorf("Post content = %v, want %v", got.Content, want.Content)
        }</span>
}

// AssertFileExists checks if a file exists at the given path
func AssertFileExists(t *testing.T, filePath string) <span class="cov0" title="0">{
        t.Helper()

        if _, err := os.Stat(filePath); os.IsNotExist(err) </span><span class="cov0" title="0">{
                t.Errorf("Expected file %s does not exist", filePath)
        }</span>
}

// AssertFileNotExists checks if a file does not exist at the given path
func AssertFileNotExists(t *testing.T, filePath string) <span class="cov0" title="0">{
        t.Helper()

        if _, err := os.Stat(filePath); !os.IsNotExist(err) </span><span class="cov0" title="0">{
                t.Errorf("Expected file %s should not exist", filePath)
        }</span>
}

// AssertFileContains checks if a file contains the specified content
func AssertFileContains(t *testing.T, filePath, content string) <span class="cov0" title="0">{
        t.Helper()

        fileContent, err := os.ReadFile(filePath)
        if err != nil </span><span class="cov0" title="0">{
                t.Errorf("Failed to read file %s: %v", filePath, err)
                return
        }</span>

        <span class="cov0" title="0">fileStr := string(fileContent)
        if !containsString(fileStr, content) </span><span class="cov0" title="0">{
                t.Errorf("File %s should contain %q", filePath, content)
        }</span>
}

// containsString checks if a string contains a substring
func containsString(s, substr string) bool <span class="cov0" title="0">{
        return len(s) &gt;= len(substr) &amp;&amp; indexOf(s, substr) &gt;= 0
}</span>

// indexOf returns the index of the first occurrence of substr in s, or -1 if not found
func indexOf(s, substr string) int <span class="cov0" title="0">{
        for i := 0; i &lt;= len(s)-len(substr); i++ </span><span class="cov0" title="0">{
                if s[i:i+len(substr)] == substr </span><span class="cov0" title="0">{
                        return i
                }</span>
        }
        <span class="cov0" title="0">return -1</span>
}
</pre>
		
		</div>
	</body>
	<script>
	(function() {
		var files = document.getElementById('files');
		var visible;
		files.addEventListener('change', onChange, false);
		function select(part) {
			if (visible)
				visible.style.display = 'none';
			visible = document.getElementById(part);
			if (!visible)
				return;
			files.value = part;
			visible.style.display = 'block';
			location.hash = part;
		}
		function onChange() {
			select(files.value);
			window.scrollTo(0, 0);
		}
		if (location.hash != "") {
			select(location.hash.substr(1));
		}
		if (!visible) {
			select("file0");
		}
	})();
	</script>
</html>
